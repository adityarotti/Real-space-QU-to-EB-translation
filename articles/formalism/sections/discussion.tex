\section{Discussion}\label{sec:discussion}
In this work, we presented a first derivation of the real space operators on the sphere that transforms the Stokes vector to into a vector of scalars and vice versa. We also presented real space operators that directly decompose the full Stokes vector \vp{} into vector \vp{E} and \vp{B} that correspond to the respective scalar modes.  To facilitate these derivations we introduced a vector-matrix notation which allows for concise book keeping of all the standard operations involved in the analysis of (spin-2 fields) polarization maps on the sphere. This real-space analysis method trivially generalizes to maps of arbitrary spin.


These real space operators offer a spatially intuitive way of understanding the different decompositions of the Stokes vector on the sphere. We explicitly  demonstrated that all the real space operators are separable into azimuthal and radial parts. While the azimuthal part of the operators is primarily responsible for handling the spin decomposition, the radial weights determine the non-local dependence of the resulting fields on the original fields.  Only the radial part of the kernel depends on the band limit. 
The radial part of the operator kernel are roughly self-similar in the sense that the radial kernels evaluated with some band limit is related to another radial kernel evaluated with a different band limit by a simple rescaling of the function. We use this property to define a non-locality parameter $\beta_0$ which is simply the angular distance at which the amplitude of the radial kernel falls below one percent of its maxima and it  is a function of the maximum multipole $\ell_{\rm max}$ available for the analysis. We empirically show that the non-locality parameter is approximately given by: $\beta_0 = \mathrm{min}(180^{\circ}, 180^{\circ} \frac{\ell_{0}}{\ell_{\rm max}})$ with $\ell_{0}=22$ for the operator that converts Stokes Q/U to scalars E/B and vice versa (see \fig{fig:rad_ker_decay}). \revisit{An analysis in  \cite{Zaldarriaga2001a} treated real space $E/B$ operators in the flat sky.  It did not explicitly derive the radial part of the kernel, but argued on geometric grounds that it should fall with angular separation as $\beta^{-2}$.  We find that this agrees with the average behavior of radial functions after averaging oscillations, and some such averaging takes place due to pixelization of the signal.  However, for precision reconstruction of $E/B$ on the sphere, the oscillations must be taken into account.}

Our careful study of the real space operators show that they can be expressed either as a Green's function or as a convolving beam function.  \revisit{The convolution interpretation is not a totally new concept.  It guides the discussion in \cite{Zaldarriaga2001a} and closely relates to the popular spokes and pinwheel descriptions of the $E/B$ modes.  However, the Green's function interpretation of the operators is a new one and is discussed here for the first time.} These two different interpretations of the operators emerge from the expression of the kernels in terms of the forward or inverse rotation Euler angles.  

The Green's function interpretation provides some useful insights into these operations. In particular it allows us to think of ${}_{+2}X=Q+iU$ as some spin-2 charge which radiates out a complex spin-0 scalar field $E+iB$. The resulting complex scalar maps can be then understood as arising from superposition of the radiated spin-0 scalar fields emanating from all the spin charges on the sphere.  The $E/B$ mode maps are merely the real and imaginary parts of this field.


Results that demonstrate the equivalence of these real space methods to the conventional harmonic space methods will be presented in the next paper in this series.

Deeper understanding of the non-locality of the real space operators has allowed us to generalize the real space operators that transform between the spin-2 and spin-0 representations of the CMB polarization. We showed how to modify and gereralize the construction of the scalar polarization fields and to control the radial kernels, specifying them with few restrictions.  We argue that these modifications to the radial kernel have the same effect as a smoothing operation on the $E/B$ fields by a circularly symmetric beam.  Therefore it is trivial to recover the standard CMB angular power spectra from the modified scalar polarization maps resulting from the modified kernels.  Noting that that the standard spin-raising ($\eth^2$) and spin-lowering ($\bar{\eth}^2$) operators are special cases of these generalized operators, we presented a band limited representation of these operators. 


%\revisit{Discussion on results from polarized filaments, compare and contrast with those in \cite{Zaldarriaga2001a}.}

Modified real-space operators with compact kernels could open several alternative analysis routes in the future.  No spin-harmonic transforms are necessary as the real space operators only rely on computing the Euler angles which can be done on the fly.  The radial functions (depending on $P_{\ell}^{2}$) need be tabulated only once at some determined resolution.  Especially given the Green's function interpretation of these operators, their implementation is trivially parallelizable over a compact domain, since the $E/B$ contribution from the Stokes charges in each pixel can be evaluated independently.  

%Although the scaling for the real space method (${\cal O}(N_{\rm pix}^2)$) is steeper than for the spherical harmonic transforms (${\cal O}(N_{\rm pix}^{3/2})$), the simple parallelization and the small prefactor for compact kernels at high-resolution / high-band-limit could make it faster in some contexts.  It can have a small memory footprint.  \comment{Does parallel S2hat have memory constraints at high l?}  The evaluation of contribution from charges in the masked portion of the sky can simply be omitted.  \comment{hybrid low-l / high-l schemes}


\revisit{The real space kernels could in principle be incorporated into the pointing matrices for map making, allowing maps of $E/B$ to be made directly from instrument data, without the need for Stokes parameter maps as intermediate products.
  The pointing matrix---projecting the maps into the time-ordered data at a point---requires the convolution version of the kernel, while the transpose pointing matrix---projecting the time-ordered data to the map---requires the Green's function kernel.
  The method would be similar to pixel-based strategies to deconvolve an instrument beam during map making \citep[e.g.][]{2010ApJS..187..212C}.  However, such a strategy for map making would force the pointing matrix to be much less sparse and it may not be practical.}
 
Since the real space operators let us tune the locality of $E/B$ maps, this can be potentially exploited to eliminate foreground contamination from distant parts of the sky. Such applications can be difficult to implement using conventional harmonic space methods.  For instance, the real space operators can be defined such that the locality of their radial kernels is varied on different portions of the sky, dictated by say the foreground morphology, resulting in some modified scalar $E'/B'$ maps.  While this idea seems interesting, the usefulness of this implementation will depend on whether the standard $E/B$ mode spectra are easily recoverable in this fashion.  We will explore some of these possible analysis directions in the future papers of this series.

Finally, the toolbox of real-space operators gives us more intuition about the $E$- and $B$-mode structure of polarized gas and dust filaments in the Milky Way, an important foreground for inflationary science. We demonstrate that filaments with finite length or changing radius of curvature result in $B$-mode patterns in addition to the $E$-mode pattern already expected.  We therefore predict a characteristic $B$-mode pattern from filament sources that should be accesible in data.

%\revisit{The discussion till now gives the impression that using the localized convolution kernels is no different from from using the default kernel and altering the spherical harmonic coefficients of expansion of the relavant fields by appropriately operating on them with the  effective beam functions $g_{\ell}$. To appreciate the difference between these two, it is important to realize that in general one can make a choice of a radial function which may not have a band limited description. In such a case these two method of evaluating the relevant fields is not identical. An example of this claim is depicted in \fig{fig:example_gbeta}.\\
%Another important thing to realize is that the harmonic coefficients derived from default full sky operations get some contributions from different portions of sky. For instance evaluating the E and B fields in the vicinity of the poles is are prone to receiving significant contributions from strong foregrounds near the equator. Correcting the harmonic coefficients of expansion with the effective beam function does not cancel these non-local contribution. On the contrary by performing the convolution with the localized real space kernels, the regions which contribute to the local field evaluations are predetermined by the choice of the radial function.}
 
 

 
