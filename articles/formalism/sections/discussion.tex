\section{Discussion}\label{sec:discussion}
In this work, we presented a first derivation of the real space operators on the sphere that transforms the Stokes vector to into a vector of scalars and vice versa. We also presented real space operators that directly decompose the full Stokes vector \vp{} into vector \vp{E} and \vp{B} that correspond to the respective scalar modes.  To facilitate these derivations we introduced a vector-matrix notation which allows for concise book keeping of all the standard operations involved in the analysis of (spin-2 fields) polarization maps on the sphere. This real-space analysis method trivially generalizes to maps of arbitrary spin.


These real space operators offer a spatially intuitive way of understanding the different decompositions of the Stokes vector on the sphere. We explicitly  demonstrated that all the real space operators are separable into azimuthal and radial parts. While the azimuthal part of the operators is primarily responsible for handling the spin decomposition, the radial weights determine the non-local dependence of the resulting fields on the original fields.  Only the radial part of the kernel depends on the band limit. 
The radial part of the operator kernel are roughly self-similar in the sense that the radial kernels evaluated with some band limit is related to another radial kernel evaluated with a different band limit by a simple rescaling of the function. We use this property to define a non-locality parameter $\beta_0$ which is simply the angular distance at which the amplitude of the radial kernel falls below one percent of its maxima and it  is a function of the maximum multipole $\ell_{\rm max}$ available for the analysis. We empirically show that the non-locality parameter is approximately given by: $\beta_0 = \mathrm{min}(180, 180 \frac{\ell_{0}}{\ell_{\rm max}})$ with $\ell_{0}=22$ for the operator that converts Stokes Q/U to scalars E/B and vice versa (see \fig{fig:rad_ker_decay}). \revisit{A similar equation for real space $E/B$ operators was derived in \cite{Zaldarriaga2001a}, treating the flat sky case and not explicitly deriving the radial kernel.} \comment{Need to build in the relating to the Zaldariagga power law radial function here.}

Our careful study of the real space operators show that they can be expressed either as a Green's function or as a convolving beam function. While the convolving beam interpretation is well known and leads to the popular spokes and pinwheel descriptions of the $E/B$ modes, the Green's function interpretation of the operators is a new one and discussed for the first time in this work. These two different interpretations of the operators emerge depending on whether the kernels are expressed in terms of the forward or inverse rotation Euler angles.  

The Green's function interpretation provides some useful insights into these operations. In particular it allows us to think of ${}_{+2}X=Q+iU$ as some spin-2 charge which radiates out a complex spin-0 scalar field $E+iB$. The resulting complex scalar maps can be then understood as arising from superposition of the radiated spin-0 scalar fields emanating from all the spin charges on the sphere.  The $E/B$ mode maps are merely the real and imaginary parts of this field.

A deeper understanding of the non-locality of the real space operators allowed us to generalize the real space operators that transform between the spin-2 and spin-0 representations of the CMB polarization. We showed how to modify and gereralize the construction of the scalar polarization fields and to control the radial kernels, specifying them with few restrictions.  We argue that these modifications to the radial kernel have the same effect as a smoothing operation on the scalar fields by a circularly symmetric beam.  Therefore it is trivial to recover the standard CMB angular power spectra from the modified scalar polarization maps estimated using the modified kernels.  Noting that that the standard spin-raising ($\eth^2$) and spin-lowering ($\bar{\eth}^2$) operators are special cases of these generalized operators, we presented a band limited representation of these operators. 

The toolbox of real-space operators gives us more intuition about the $E$- and $B$-mode structure of polarized filaments in the Milky Way gas and dust, potentially important sources of foregrounds for inflationary science. We demonstrate that filaments with finite length and/or changing radius of curvature results in a definite $B$-mode pattern in addition to the conventional $E$-mode pattern expected from filaments. We therefore predict a characteristic $B$-mode pattern from filament sources.

%\revisit{Discussion on results from polarized filaments, compare and contrast with those in \cite{Zaldarriaga2001a}.}

Several alternative analysis routes emerge from considering  these real space operators.  No spin-harmonic transforms are necessary as the real space operators only rely on computing the Euler angles which can be done on the fly.  The radial functions (depending on $P_{\ell}^{2}$) need be tabulated only once at some determined resolution.  Especially given the Green's function interpretation of these operators, their implementation is trivially parallelizable, since the $E/B$ contribution from the Stokes charges in each pixel can be evaluated independently.  

%Although the scaling for the real space method (${\cal O}(N_{\rm pix}^2)$) is steeper than for the spherical harmonic transforms (${\cal O}(N_{\rm pix}^{3/2})$), the simple parallelization and the small prefactor for compact kernels at high-resolution / high-band-limit could make it faster in some contexts.  It can have a small memory footprint.  \comment{Does parallel S2hat have memory constraints at high l?}  The evaluation of contribution from charges in the masked portion of the sky can simply be omitted.  \comment{hybrid low-l / high-l schemes}

\revisit{Further the Green's function interpretation of the  real space operators and their locality, suggests the possibility of converting the Stokes parameter time ordered data to scalar $E/B$ time ordered data given the pointing model for the observations, which can then be subsequently converted to maps of $E/B$ modes using standard map making techniques.}  \comment{K: question whether this actually works.  What does E/B tod really mean?}

Since the real space operators let us tune the locality of $E/B$ maps, this can be potentially exploited to eliminate foreground contamination from distant parts of the sky. Such applications can be difficult to implement using conventional harmonic space methods.  For instance, the real space operators can be defined such that the locality of their radial kernels is varied on different portions of the sky, dictated by say the foreground morphology, resulting in some modified scalar $E'/B'$ maps.  While this idea seems interesting, the usefulness of this implementation will depend on whether the standard $E/B$ mode spectra are easily recoverable in this fashion.  

Results that demonstrate the equivalence of these real space methods to the conventional harmonic space methods will be presented in the next paper in this series, along with explorations of some of the ideas discussed above.

%\revisit{The discussion till now gives the impression that using the localized convolution kernels is no different from from using the default kernel and altering the spherical harmonic coefficients of expansion of the relavant fields by appropriately operating on them with the  effective beam functions $g_{\ell}$. To appreciate the difference between these two, it is important to realize that in general one can make a choice of a radial function which may not have a band limited description. In such a case these two method of evaluating the relevant fields is not identical. An example of this claim is depicted in \fig{fig:example_gbeta}.\\
%Another important thing to realize is that the harmonic coefficients derived from default full sky operations get some contributions from different portions of sky. For instance evaluating the E and B fields in the vicinity of the poles is are prone to receiving significant contributions from strong foregrounds near the equator. Correcting the harmonic coefficients of expansion with the effective beam function does not cancel these non-local contribution. On the contrary by performing the convolution with the localized real space kernels, the regions which contribute to the local field evaluations are predetermined by the choice of the radial function.}
 
 

 
